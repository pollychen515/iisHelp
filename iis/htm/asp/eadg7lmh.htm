<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Transaction Processing Technology</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1><A NAME="_k2_transaction_processing_technology"></A><SUP></SUP>Transaction Processing Technology</H1>

<P>The primary technology that makes it possible for an ASP to participate in a transaction is Component Services. Component Services provides IIS with transaction services and an environment for hosting component instances. One of the benefits of this environment is the ability to create attributes for individual component instances. When IIS compiles an ASP script, a new instance of the IIS Web Application Manager (IISWAM) is created. IISWAM is a COM component that IIS uses to manage applications. If the ASP script contains the @TRANSACTION directive, the instance of IISWAM will be declared within the transaction environment with an appropriate transaction property. For example, if you include @TRANSACTION = Required in your ASP script, you are telling Component Services that the instance of IISWAM that it creates should be run in a transaction. If the ASP script creates instances of any other components that have been registered with Component Services, Component Services will treat them as part of the same transaction. The following diagram illustrates the relationship between ASP and IISWAM.</P>

<P><IMG SRC="/iishelp/iis/htm/asp/art/iiswam.gif" ALT="IIS Web Application Manager" BORDER=0></P>

<P>Component Services provides transaction services to IIS through two different layers. At the lowest layer, Component Services interacts with the Microsoft Distributed Transaction Coordinator (MS DTC) to guarantee that transactions meet the ACID properties (Atomic, Consistent, Isolated, Durable) of a reliable transaction processing system. Component Services links component instances to MS DTC through two mechanisms: resource managers and resource dispensers. A resource manager is a system service that manages durable data. Component Services supports resource managers that implement either the OLE Transactions protocol, such as Microsoft SQL Server 6.5, or the X/Open DTP XA standard. Resource dispensers are similar to resource managers in that they work with components to share state information. However, the information they share is not durable. For example, resource dispensers can manage pools of database connections for components that use standard ODBC interfaces. The ODBC 3.0 Driver Manager is the resource dispenser for ODBC connections.</P>

<P>For more information on Component Services transactions, see <A HREF="iiaptran.htm">Understanding Transactions</A> and the Component Services and Message Queuing documentation in the Platform SDK. To view samples of transactional scripting, see <A HREF="/iishelp/iis/htm/asp/asps6243.htm">ASP Transaction Services</A> in ASP Samples.</P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-1999 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
