<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Ad Rotator Component</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1><A NAME="_ad_rotator_component"></A>Ad Rotator Component</H1>

<P>The Ad Rotator component creates an <B>Ad Rotator</B> object that automates the rotation of advertisement images on a Web page. Each time a user opens or reloads the Web page, the Ad Rotator component displays a new advertisement based on the information you specify in a <A HREF="/iishelp/iis/htm/asp/comp6okl.htm">Rotator Schedule File</A>.</P>

<P>You can record how many users click each advertisement by setting the URL parameter in the Rotator Schedule file to direct users to the Redirection File. When you specify this parameter, each jump to an advertiser's URL is recorded in the Web server activity logs. </P>

<H6>File Names</H6>

<TABLE border=0 cellpadding=5 cols=2>

<TR VALIGN="top">
<TD width=25%>Adrot.dll </TD>
<TD width=75%>The Ad Rotator<B> </B>component.</TD>
</TR>

<TR VALIGN="top">
<TD width=25%><A HREF="/iishelp/iis/htm/asp/comp6okl.htm">Rotator Schedule File</A></TD>
<TD width=75%>A text file that contains the display schedule and file information for advertisements. This file must be available on a Web server virtual path.</TD>
</TR>

<TR VALIGN="top">
<TD width=25%><A HREF="/iishelp/iis/htm/asp/comp0hr9.htm">Redirection File</A></TD>
<TD width=75%>An optional file that implements redirection and enables the Ad Rotator component to record how many users click on each advertisement.</TD>
</TR>
</TABLE><BR>

<H6>Syntax</H6>

<P><B>Set </B><I>AdRotator</I> <B>= Server.CreateObject( "MSWC.AdRotator" )</B></P>

<H6>Parameters</H6>

<DL>
<DT><I>AdRotator</I></DT>

<DD>Specifies the name of the <B>AdRotator </B>object created by the call to <B>Server.CreateObject</B>.</DD>
</DL>

<H6>Properties</H6>

<TABLE border=0 cellpadding=5 cols=2>

<TR VALIGN="top">
<TD width=48%><A HREF="/iishelp/iis/htm/asp/comp14fm.htm"><B>Border</B></A></TD>
<TD width=52%>Specifies the size of the border around the advertisement.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="/iishelp/iis/htm/asp/comp5279.htm"><B>Clickable</B></A></TD>
<TD width=52%>Specifies whether the advertisement is a hyperlink.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="/iishelp/iis/htm/asp/comp1ag5.htm"><B>TargetFrame</B></A> </TD>
<TD width=52%>Specifies the name of the frame in which to display the advertisement.</TD>
</TR>
</TABLE><BR>

<H6>Methods</H6>

<TABLE border=0 cellpadding=5 cols=2>

<TR VALIGN="top">
<TD width=48%><A HREF="/iishelp/iis/htm/asp/comp4z90.htm"><B>GetAdvertisement</B></A></TD>
<TD width=52%>Gets the specifications for the next scheduled advertisement from the data file and formats it as HTML.</TD>
</TR>
</TABLE><BR>

<H6>Example</H6>

<P>The following example displays a different advertisement each time a user views the Web page. </P>

<PRE><CODE>&lt;%  Set ad = Server.CreateObject("MSWC.AdRotator") %&gt;  
 
&lt;%= ad.GetAdvertisement("/ads/adrot.txt") %&gt;  
 </CODE></PRE>

<P>The following HTML is generated by the <B>GetAdvertisement</B> method and is added to the page's output, displaying the next advertisement in the Rotator Schedule file.</P>

<PRE><CODE>&lt;A HREF="http://www.msn.com/isapi/adredir.asp?http://www.company.com/"&gt; 

&lt;IMG SRC="http://msnnt3web/ads/homepage/chlogolg.gif" 
ALT="Check out the new Technology Center" 
WIDTH=440 HEIGHT=60 BORDER=1&gt;&lt;/A&gt; 
 </CODE></PRE>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-1999 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
